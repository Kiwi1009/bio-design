<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Need Statement è¾¯è«–ç³»çµ± - Biodesign LLM Agent</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 0;
            min-height: 600px;
        }

        .input-panel {
            background: #f8f9fa;
            padding: 30px;
            border-right: 2px solid #e9ecef;
        }

        .debate-panel {
            background: white;
            padding: 30px;
            position: relative;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 1.1em;
        }

        .form-group textarea {
            width: 100%;
            height: 120px;
            padding: 15px;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            transition: all 0.3s ease;
        }

        .form-group textarea:focus {
            outline: none;
            border-color: #3498db;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            font-size: 14px;
            background: white;
        }

        .submit-btn {
            width: 100%;
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 20px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(52, 152, 219, 0.3);
        }

        .submit-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .status-indicator {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: 600;
            display: none;
        }

        .status-indicator.loading {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .status-indicator.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-indicator.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .debate-container {
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .debate-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e9ecef;
        }

        .debate-title {
            font-size: 1.5em;
            color: #2c3e50;
            font-weight: 600;
        }

        .debate-controls {
            display: flex;
            gap: 10px;
        }

        .control-btn {
            padding: 8px 16px;
            border: 2px solid #3498db;
            background: white;
            color: #3498db;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .control-btn:hover {
            background: #3498db;
            color: white;
        }

        .control-btn.active {
            background: #3498db;
            color: white;
        }

        .debate-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 1px solid #e9ecef;
        }

        .debate-message {
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 10px;
            position: relative;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .debate-message.medical {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border-left: 5px solid #2196f3;
        }

        .debate-message.engineering {
            background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%);
            border-left: 5px solid #9c27b0;
        }

        .debate-message.coordinator {
            background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
            border-left: 5px solid #4caf50;
        }

        .debate-message.system {
            background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
            border-left: 5px solid #ff9800;
        }

        .message-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .agent-name {
            font-weight: 600;
            font-size: 1.1em;
            color: #2c3e50;
        }

        .message-time {
            font-size: 0.9em;
            color: #7f8c8d;
        }

        .message-content {
            line-height: 1.6;
            color: #2c3e50;
        }

        .thinking-indicator {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 20px;
            background: #fff3cd;
            border-radius: 10px;
            border: 1px solid #ffeaa7;
            margin-bottom: 20px;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .results-summary {
            background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border: 1px solid #4caf50;
        }

        .results-summary h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .need-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 4px solid #4caf50;
        }

        .need-item h4 {
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .need-item p {
            color: #555;
            line-height: 1.5;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #7f8c8d;
        }

        .empty-state h3 {
            margin-bottom: 15px;
            color: #95a5a6;
        }

        .empty-state p {
            line-height: 1.6;
        }

        .example-needs {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }

        .example-needs h4 {
            color: #2c3e50;
            margin-bottom: 15px;
        }

        .example-need {
            background: white;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid #e9ecef;
        }

        .example-need:hover {
            background: #e3f2fd;
            border-color: #2196f3;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e9ecef;
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3498db, #2ecc71);
            width: 0%;
            transition: width 0.3s ease;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .input-panel {
                border-right: none;
                border-bottom: 2px solid #e9ecef;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¦· Need Statement è¾¯è«–ç³»çµ±</h1>
            <p>åŸºæ–¼LLMä»£ç†çš„Biodesignæ–¹æ³•è«– - å¤šä»£ç†å”ä½œè¾¯è«–åˆ†æ</p>
        </div>

        <div class="main-content">
            <!-- è¼¸å…¥é¢æ¿ -->
            <div class="input-panel">
                <h3 style="color: #2c3e50; margin-bottom: 20px;">ğŸ“ è¼¸å…¥æ‚¨çš„ Need Statement</h3>
                
                <div class="form-group">
                    <label for="needStatement">Need Statement:</label>
                    <textarea 
                        id="needStatement" 
                        placeholder="è«‹æè¿°æ‚¨è­˜åˆ¥å‡ºçš„é†«ç™‚éœ€æ±‚æˆ–å•é¡Œ...&#10;&#10;ä¾‹å¦‚ï¼š&#10;ç³–å°¿ç—…æ‚£è€…éœ€è¦æ›´å¥½çš„è¡€ç³–ç›£æ¸¬è¨­å‚™ï¼ŒåŒ…æ‹¬é€£çºŒç›£æ¸¬å’Œæ™ºèƒ½æé†’åŠŸèƒ½"
                    ></textarea>
                </div>

                <div class="form-group">
                    <label for="maxRounds">è¾¯è«–è¼ªæ•¸:</label>
                    <select id="maxRounds">
                        <option value="2">2 è¼ª (å¿«é€Ÿåˆ†æ)</option>
                        <option value="3" selected>3 è¼ª (æ¨™æº–åˆ†æ)</option>
                        <option value="4">4 è¼ª (æ·±åº¦åˆ†æ)</option>
                        <option value="5">5 è¼ª (å…¨é¢åˆ†æ)</option>
                    </select>
                </div>

                <button id="startDebateBtn" class="submit-btn" onclick="startDebate()">
                    ğŸš€ é–‹å§‹è¾¯è«–åˆ†æ
                </button>

                <div id="statusIndicator" class="status-indicator"></div>

                <div class="example-needs">
                    <h4>ğŸ’¡ ç¤ºä¾‹ Need Statements:</h4>
                    <div class="example-need" onclick="loadExample('diabetes')">
                        <strong>ç³–å°¿ç—…ç®¡ç†:</strong> æ‚£è€…éœ€è¦æ›´å¥½çš„è¡€ç³–ç›£æ¸¬å’Œç”¨è—¥æé†’ç³»çµ±
                    </div>
                    <div class="example-need" onclick="loadExample('dental')">
                        <strong>ç‰™ç§‘æ‰‹è¡“:</strong> éœ€è¦3Då»ºæ¨¡å’ŒVRæ¨¡æ“¬ä¾†æå‡æ‰‹è¡“å‰è¦åŠƒ
                    </div>
                    <div class="example-need" onclick="loadExample('elderly')">
                        <strong>è€å¹´ç…§è­·:</strong> ç¨å±…è€äººéœ€è¦æ™ºèƒ½ç›£æ¸¬å’Œç·Šæ€¥æ±‚åŠ©ç³»çµ±
                    </div>
                </div>
            </div>

            <!-- è¾¯è«–å±•ç¤ºé¢æ¿ -->
            <div class="debate-panel">
                <div class="debate-container">
                    <div class="debate-header">
                        <div class="debate-title">ğŸ¤– å¤šä»£ç†è¾¯è«–éç¨‹</div>
                        <div class="debate-controls">
                            <button class="control-btn active" onclick="showView('debate')">è¾¯è«–éç¨‹</button>
                            <button class="control-btn" onclick="showView('results')">è¾¯è«–çµæœ</button>
                            <button class="control-btn" onclick="showView('summary')">éœ€æ±‚ç¸½çµ</button>
                        </div>
                    </div>

                    <div class="progress-bar">
                        <div id="progressFill" class="progress-fill"></div>
                    </div>

                    <!-- è¾¯è«–éç¨‹è¦–åœ– -->
                    <div id="debateView" class="debate-content">
                        <div class="empty-state">
                            <h3>ğŸ¯ æº–å‚™é–‹å§‹è¾¯è«–</h3>
                            <p>è«‹åœ¨å·¦å´è¼¸å…¥æ‚¨çš„ Need Statementï¼Œç„¶å¾Œé»æ“Šã€Œé–‹å§‹è¾¯è«–åˆ†æã€æŒ‰éˆ•ã€‚</p>
                            <p>ç³»çµ±å°‡å•Ÿå‹•å¤šå€‹AIä»£ç†é€²è¡Œå”ä½œè¾¯è«–ï¼Œåˆ†ææ‚¨çš„éœ€æ±‚ä¸¦æå‡ºè§£æ±ºæ–¹æ¡ˆã€‚</p>
                        </div>
                    </div>

                    <!-- è¾¯è«–çµæœè¦–åœ– -->
                    <div id="resultsView" class="debate-content" style="display: none;">
                        <div class="empty-state">
                            <h3>ğŸ“Š è¾¯è«–çµæœ</h3>
                            <p>è¾¯è«–å®Œæˆå¾Œï¼Œé€™è£¡å°‡é¡¯ç¤ºè©³ç´°çš„åˆ†æçµæœå’Œå»ºè­°ã€‚</p>
                        </div>
                    </div>

                    <!-- éœ€æ±‚ç¸½çµè¦–åœ– -->
                    <div id="summaryView" class="debate-content" style="display: none;">
                        <div class="empty-state">
                            <h3>ğŸ“‹ éœ€æ±‚ç¸½çµ</h3>
                            <p>è¾¯è«–å®Œæˆå¾Œï¼Œé€™è£¡å°‡é¡¯ç¤ºè­˜åˆ¥å‡ºçš„é—œéµéœ€æ±‚å’Œå¯¦æ–½å»ºè­°ã€‚</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentSessionId = null;
        let debateMessages = [];
        let debateResults = null;
        let currentView = 'debate';

        // è¼‰å…¥ç¤ºä¾‹
        function loadExample(type) {
            const examples = {
                diabetes: 'ç³–å°¿ç—…æ‚£è€…éœ€è¦æ›´å¥½çš„è¡€ç³–ç›£æ¸¬è¨­å‚™ï¼ŒåŒ…æ‹¬é€£çºŒç›£æ¸¬ã€æ™ºèƒ½æé†’åŠŸèƒ½å’Œæ•¸æ“šåˆ†æï¼Œä»¥æå‡è‡ªæˆ‘ç®¡ç†èƒ½åŠ›å’Œæ²»ç™‚æ•ˆæœã€‚',
                dental: 'ç‰™ç§‘é†«å¸«éœ€è¦3Då»ºæ¨¡å’ŒVRæ¨¡æ“¬ç³»çµ±ä¾†é€²è¡Œæ‰‹è¡“å‰è¦åŠƒï¼Œæå‡æ‰‹è¡“ç²¾æº–åº¦ã€æ‚£è€…æºé€šæ•ˆæœå’Œæ‰‹è¡“æˆåŠŸç‡ã€‚',
                elderly: 'ç¨å±…è€äººéœ€è¦æ™ºèƒ½å¥åº·ç›£æ¸¬ç³»çµ±ï¼ŒåŒ…æ‹¬ç”Ÿå‘½é«”å¾µç›£æ¸¬ã€è·Œå€’æª¢æ¸¬ã€ç·Šæ€¥æ±‚åŠ©å’Œé ç¨‹ç…§è­·åŠŸèƒ½ï¼Œä»¥æå‡å±…å®¶å®‰å…¨æ€§ã€‚'
            };
            
            document.getElementById('needStatement').value = examples[type];
        }

        // é–‹å§‹è¾¯è«–
        async function startDebate() {
            const needStatement = document.getElementById('needStatement').value.trim();
            const maxRounds = document.getElementById('maxRounds').value;
            
            if (!needStatement) {
                showStatus('è«‹è¼¸å…¥ Need Statement', 'error');
                return;
            }

            // é‡ç½®ç‹€æ…‹
            resetDebate();
            showStatus('æ­£åœ¨å•Ÿå‹•è¾¯è«–ç³»çµ±...', 'loading');
            
            try {
                // æäº¤è¾¯è«–è«‹æ±‚
                const response = await fetch('/api/reflection', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        query: needStatement,
                        max_rounds: parseInt(maxRounds)
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    currentSessionId = data.session_id;
                    showStatus('è¾¯è«–å·²å•Ÿå‹•ï¼Œæ­£åœ¨ç­‰å¾…ä»£ç†å›æ‡‰...', 'loading');
                    
                    // é–‹å§‹ç›£è½è¾¯è«–éç¨‹
                    startDebateStream();
                } else {
                    const errorData = await response.json();
                    showStatus(`è¾¯è«–å•Ÿå‹•å¤±æ•—: ${errorData.detail || 'æœªçŸ¥éŒ¯èª¤'}`, 'error');
                }
            } catch (error) {
                showStatus(`é€£æ¥éŒ¯èª¤: ${error.message}`, 'error');
            }
        }

        // é‡ç½®è¾¯è«–ç‹€æ…‹
        function resetDebate() {
            debateMessages = [];
            debateResults = null;
            currentSessionId = null;
            updateDebateView();
            updateProgress(0);
        }

        // é–‹å§‹è¾¯è«–ä¸²æµ
        function startDebateStream() {
            if (!currentSessionId) return;

            // æ¨¡æ“¬è¾¯è«–éç¨‹ï¼ˆå¯¦éš›æ‡‰è©²ä½¿ç”¨ Server-Sent Eventsï¼‰
            simulateDebateProcess();
        }

        // æ¨¡æ“¬è¾¯è«–éç¨‹
        function simulateDebateProcess() {
            const needStatement = document.getElementById('needStatement').value;
            const maxRounds = parseInt(document.getElementById('maxRounds').value);
            
            // æ¸…ç©ºç¾æœ‰æ¶ˆæ¯
            debateMessages = [];
            updateDebateView();

            // æ¨¡æ“¬è¾¯è«–é–‹å§‹
            addDebateMessage('system', 'ğŸ¯ è¾¯è«–é–‹å§‹', `é–‹å§‹åˆ†æ Need Statement: "${needStatement}"`, 'system');
            updateProgress(10);

            // æ¨¡æ“¬ç¬¬ä¸€è¼ªè¾¯è«–
            setTimeout(() => {
                addDebateMessage('medical', 'ğŸ©º é†«ç™‚å°ˆå®¶ä»£ç†', 'å¾é†«ç™‚è§’åº¦åˆ†æï¼Œé€™å€‹éœ€æ±‚æ¶‰åŠæ‚£è€…å®‰å…¨ã€æ²»ç™‚æ•ˆæœå’Œé†«ç™‚æµç¨‹å„ªåŒ–ã€‚æˆ‘å»ºè­°å¾è‡¨åºŠåƒ¹å€¼å’Œæ‚£è€…å½±éŸ¿å…©å€‹ç¶­åº¦é€²è¡Œè©•ä¼°ã€‚', 'medical');
                updateProgress(25);
            }, 2000);

            setTimeout(() => {
                addDebateMessage('engineering', 'âš™ï¸ ç³»çµ±å·¥ç¨‹å¸«ä»£ç†', 'å¾æŠ€è¡“è§’åº¦ä¾†çœ‹ï¼Œé€™å€‹éœ€æ±‚éœ€è¦æ•´åˆå¤šç¨®æŠ€è¡“ï¼ŒåŒ…æ‹¬æ„Ÿæ¸¬å™¨ã€æ•¸æ“šè™•ç†ã€ç”¨æˆ¶ç•Œé¢ç­‰ã€‚æˆ‘å»ºè­°æ¡ç”¨æ¨¡çµ„åŒ–è¨­è¨ˆï¼Œç¢ºä¿ç³»çµ±çš„å¯æ“´å±•æ€§å’Œç¶­è­·æ€§ã€‚', 'engineering');
                updateProgress(40);
            }, 4000);

            setTimeout(() => {
                addDebateMessage('coordinator', 'ğŸ“‹ éœ€æ±‚æ”¶é›†è€…ä»£ç†', 'åŸºæ–¼å…©ä½å°ˆå®¶çš„åˆ†æï¼Œæˆ‘è­˜åˆ¥å‡ºä¸‰å€‹é—œéµéœ€æ±‚ï¼š1) æ ¸å¿ƒåŠŸèƒ½ç³»çµ± 2) æ•¸æ“šåˆ†æå¹³å° 3) ç”¨æˆ¶é«”é©—å„ªåŒ–ã€‚è®“æˆ‘å€‘æ·±å…¥è¨è«–æ¯å€‹éœ€æ±‚çš„å¯¦æ–½ç­–ç•¥ã€‚', 'coordinator');
                updateProgress(55);
            }, 6000);

            // æ¨¡æ“¬ç¬¬äºŒè¼ªè¾¯è«–
            setTimeout(() => {
                addDebateMessage('medical', 'ğŸ©º é†«ç™‚å°ˆå®¶ä»£ç†', 'é‡å°è­˜åˆ¥å‡ºçš„éœ€æ±‚ï¼Œæˆ‘èªç‚ºæ‡‰è©²å„ªå…ˆè€ƒæ…®æ‚£è€…å®‰å…¨æ€§ã€‚å»ºè­°å»ºç«‹é¢¨éšªè©•ä¼°æ©Ÿåˆ¶å’Œæ‡‰æ€¥è™•ç†æµç¨‹ã€‚', 'medical');
                updateProgress(70);
            }, 8000);

            setTimeout(() => {
                addDebateMessage('engineering', 'âš™ï¸ ç³»çµ±å·¥ç¨‹å¸«ä»£ç†', 'å¾æŠ€è¡“å¯¦æ–½è§’åº¦ï¼Œæˆ‘å»ºè­°æ¡ç”¨æ•æ·é–‹ç™¼æ–¹æ³•ï¼Œåˆ†éšæ®µéƒ¨ç½²ã€‚é¦–å…ˆå»ºç«‹æ ¸å¿ƒåŠŸèƒ½ï¼Œç„¶å¾Œé€æ­¥æ·»åŠ é«˜ç´šç‰¹æ€§ã€‚', 'engineering');
                updateProgress(85);
            }, 10000);

            // è¾¯è«–å®Œæˆ
            setTimeout(() => {
                addDebateMessage('coordinator', 'ğŸ“‹ éœ€æ±‚æ”¶é›†è€…ä»£ç†', 'è¾¯è«–å®Œæˆï¼æˆ‘å·²ç¶“æ•´åˆäº†æ‰€æœ‰è¨è«–çµæœï¼Œå½¢æˆäº†è©³ç´°çš„éœ€æ±‚åˆ†æå’Œå¯¦æ–½å»ºè­°ã€‚', 'coordinator');
                updateProgress(100);
                showStatus('è¾¯è«–å®Œæˆï¼', 'success');
                
                // ç”Ÿæˆæ¨¡æ“¬çµæœ
                generateMockResults();
            }, 12000);
        }

        // æ·»åŠ è¾¯è«–æ¶ˆæ¯
        function addDebateMessage(agentType, agentName, content, messageType) {
            const message = {
                agentType,
                agentName,
                content,
                messageType,
                timestamp: new Date().toLocaleTimeString()
            };
            
            debateMessages.push(message);
            updateDebateView();
        }

        // æ›´æ–°è¾¯è«–è¦–åœ–
        function updateDebateView() {
            const debateView = document.getElementById('debateView');
            
            if (debateMessages.length === 0) {
                debateView.innerHTML = `
                    <div class="empty-state">
                        <h3>ğŸ¯ æº–å‚™é–‹å§‹è¾¯è«–</h3>
                        <p>è«‹åœ¨å·¦å´è¼¸å…¥æ‚¨çš„ Need Statementï¼Œç„¶å¾Œé»æ“Šã€Œé–‹å§‹è¾¯è«–åˆ†æã€æŒ‰éˆ•ã€‚</p>
                    </div>
                `;
                return;
            }

            let messagesHTML = '';
            debateMessages.forEach(message => {
                const messageClass = `debate-message ${message.messageType}`;
                messagesHTML += `
                    <div class="${messageClass}">
                        <div class="message-header">
                            <span class="agent-name">${message.agentName}</span>
                            <span class="message-time">${message.timestamp}</span>
                        </div>
                        <div class="message-content">${message.content}</div>
                    </div>
                `;
            });

            debateView.innerHTML = messagesHTML;
            debateView.scrollTop = debateView.scrollHeight;
        }

        // æ›´æ–°é€²åº¦æ¢
        function updateProgress(percentage) {
            document.getElementById('progressFill').style.width = percentage + '%';
        }

        // ç”Ÿæˆæ¨¡æ“¬çµæœ
        function generateMockResults() {
            debateResults = {
                needs: [
                    {
                        title: 'æ ¸å¿ƒåŠŸèƒ½ç³»çµ±',
                        description: 'å»ºç«‹åŸºç¤çš„ç›£æ¸¬å’Œæé†’åŠŸèƒ½',
                        priority: 'é«˜',
                        feasibility: '8/10',
                        impact: '9/10'
                    },
                    {
                        title: 'æ•¸æ“šåˆ†æå¹³å°',
                        description: 'æ•´åˆæ•¸æ“šæ”¶é›†ã€åˆ†æå’Œå ±å‘ŠåŠŸèƒ½',
                        priority: 'ä¸­',
                        feasibility: '7/10',
                        impact: '8/10'
                    },
                    {
                        title: 'ç”¨æˆ¶é«”é©—å„ªåŒ–',
                        description: 'å„ªåŒ–ç•Œé¢è¨­è¨ˆå’Œç”¨æˆ¶äº¤äº’æµç¨‹',
                        priority: 'ä¸­',
                        feasibility: '8/10',
                        impact: '7/10'
                    }
                ],
                summary: 'é€šéå¤šä»£ç†è¾¯è«–ï¼Œæˆ‘å€‘æˆåŠŸè­˜åˆ¥å‡ºä¸‰å€‹é—œéµéœ€æ±‚ï¼Œä¸¦åˆ¶å®šäº†åˆ†éšæ®µå¯¦æ–½ç­–ç•¥ã€‚å»ºè­°å„ªå…ˆå¯¦æ–½æ ¸å¿ƒåŠŸèƒ½ç³»çµ±ï¼Œä»¥å¿«é€Ÿç²å¾—ç”¨æˆ¶åé¥‹ã€‚'
            };
        }

        // é¡¯ç¤ºç‹€æ…‹
        function showStatus(message, type) {
            const indicator = document.getElementById('statusIndicator');
            indicator.textContent = message;
            indicator.className = `status-indicator ${type}`;
            indicator.style.display = 'block';
            
            if (type === 'success') {
                setTimeout(() => {
                    indicator.style.display = 'none';
                }, 3000);
            }
        }

        // åˆ‡æ›è¦–åœ–
        function showView(viewName) {
            currentView = viewName;
            
            // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
            document.querySelectorAll('.control-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // éš±è—æ‰€æœ‰è¦–åœ–
            document.getElementById('debateView').style.display = 'none';
            document.getElementById('resultsView').style.display = 'none';
            document.getElementById('summaryView').style.display = 'none';
            
            // é¡¯ç¤ºé¸ä¸­çš„è¦–åœ–
            document.getElementById(viewName + 'View').style.display = 'block';
            
            // æ ¹æ“šè¦–åœ–æ›´æ–°å…§å®¹
            if (viewName === 'results') {
                updateResultsView();
            } else if (viewName === 'summary') {
                updateSummaryView();
            }
        }

        // æ›´æ–°çµæœè¦–åœ–
        function updateResultsView() {
            const resultsView = document.getElementById('resultsView');
            
            if (!debateResults) {
                resultsView.innerHTML = `
                    <div class="empty-state">
                        <h3>ğŸ“Š è¾¯è«–çµæœ</h3>
                        <p>è«‹å…ˆå®Œæˆè¾¯è«–åˆ†æä»¥æŸ¥çœ‹çµæœã€‚</p>
                    </div>
                `;
                return;
            }

            let resultsHTML = `
                <h3 style="color: #2c3e50; margin-bottom: 20px;">ğŸ“Š è¾¯è«–åˆ†æçµæœ</h3>
                <div class="results-summary">
                    <h3>ğŸ“‹ è­˜åˆ¥å‡ºçš„éœ€æ±‚</h3>
            `;

            debateResults.needs.forEach((need, index) => {
                resultsHTML += `
                    <div class="need-item">
                        <h4>${index + 1}. ${need.title}</h4>
                        <p><strong>æè¿°:</strong> ${need.description}</p>
                        <p><strong>å„ªå…ˆç´š:</strong> ${need.priority}</p>
                        <p><strong>å¯è¡Œæ€§:</strong> ${need.feasibility}</p>
                        <p><strong>å½±éŸ¿åŠ›:</strong> ${need.impact}</p>
                    </div>
                `;
            });

            resultsHTML += `
                    <h3 style="margin-top: 20px;">ğŸ“ ç¸½çµ</h3>
                    <p>${debateResults.summary}</p>
                </div>
            `;

            resultsView.innerHTML = resultsHTML;
        }

        // æ›´æ–°ç¸½çµè¦–åœ–
        function updateSummaryView() {
            const summaryView = document.getElementById('summaryView');
            
            if (!debateResults) {
                summaryView.innerHTML = `
                    <div class="empty-state">
                        <h3>ğŸ“‹ éœ€æ±‚ç¸½çµ</h3>
                        <p>è«‹å…ˆå®Œæˆè¾¯è«–åˆ†æä»¥æŸ¥çœ‹ç¸½çµã€‚</p>
                    </div>
                `;
                return;
            }

            let summaryHTML = `
                <h3 style="color: #2c3e50; margin-bottom: 20px;">ğŸ“‹ éœ€æ±‚ç¸½çµèˆ‡å¯¦æ–½å»ºè­°</h3>
                <div class="results-summary">
                    <h3>ğŸ¯ å¯¦æ–½å„ªå…ˆç´š</h3>
                    <p>åŸºæ–¼è¾¯è«–çµæœï¼Œå»ºè­°æŒ‰ä»¥ä¸‹é †åºå¯¦æ–½ï¼š</p>
                    <ol style="margin: 15px 0; padding-left: 20px;">
                        <li><strong>ç¬¬ä¸€éšæ®µ (1-3å€‹æœˆ):</strong> æ ¸å¿ƒåŠŸèƒ½ç³»çµ±é–‹ç™¼èˆ‡æ¸¬è©¦</li>
                        <li><strong>ç¬¬äºŒéšæ®µ (4-6å€‹æœˆ):</strong> æ•¸æ“šåˆ†æå¹³å°æ•´åˆ</li>
                        <li><strong>ç¬¬ä¸‰éšæ®µ (7-9å€‹æœˆ):</strong> ç”¨æˆ¶é«”é©—å„ªåŒ–èˆ‡éƒ¨ç½²</li>
                    </ol>
                    
                    <h3>ğŸ’¡ é—œéµæˆåŠŸå› ç´ </h3>
                    <ul style="margin: 15px 0; padding-left: 20px;">
                        <li>ç”¨æˆ¶éœ€æ±‚å°å‘çš„è¨­è¨ˆ</li>
                        <li>åˆ†éšæ®µå¯¦æ–½ç­–ç•¥</li>
                        <li>æŒçºŒçš„ç”¨æˆ¶åé¥‹æ”¶é›†</li>
                        <li>è·¨å°ˆæ¥­åœ˜éšŠå”ä½œ</li>
                    </ul>
                    
                    <h3>âš ï¸ é¢¨éšªç®¡ç†</h3>
                    <ul style="margin: 15px 0; padding-left: 20px;">
                        <li>æŠ€è¡“é¢¨éšªï¼šé¸æ“‡æˆç†ŸæŠ€è¡“ï¼Œå»ºç«‹å‚™é¸æ–¹æ¡ˆ</li>
                        <li>ç”¨æˆ¶æ¥å—åº¦ï¼šåŠ å¼·åŸ¹è¨“èˆ‡æ”¯æŒ</li>
                        <li>ç›£ç®¡åˆè¦ï¼šèˆ‡ç›¸é—œæ©Ÿæ§‹ä¿æŒæºé€š</li>
                    </ul>
                </div>
            `;

            summaryView.innerHTML = summaryHTML;
        }

        // é é¢è¼‰å…¥å®Œæˆ
        window.onload = function() {
            console.log('Need Statement è¾¯è«–ç³»çµ±å·²è¼‰å…¥');
        };
    </script>
</body>
</html> 