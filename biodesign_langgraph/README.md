# 🏥 Biodesign 多專家辯論系統

基於 LangGraph 架構的醫療器械創新概念評估系統，實現「多專家辯論→評分→收斂」的完整流程。

## 🎯 產品目標

將 Need Statement 系統化轉為可評估的概念清單，啟動多專家代理辯論與加權評分，輸出決策建議（Top Concepts、風險清單、下一步原型與驗證計畫）。

## 🤖 專家代理角色

系統包含 7 個專業角色：

- **🩺 臨床專家**：分析臨床價值與醫療需求
- **⚙️ 工程專家**：評估技術可行性與系統整合
- **👥 人因專家**：關注使用者體驗與錯誤容忍度
- **📋 法規專家**：評估合規路徑與風險管理
- **💰 市場財務**：分析商業可行性與財務模型
- **🔒 智財專家**：評估專利潛力與FTO風險
- **👨‍⚕️ 病患給付**：考慮病患接受度與給付策略

## 🔄 三回合流程

1. **Position**：各專家提出概念
2. **Critique**：專家間相互批評與風險識別
3. **Revise+Vote**：概念修訂與多維度評分
4. **Delphi**（可選）：針對分歧面向進行收斂

## 📊 評分系統

基於 Biodesign-Invent 評估面向的加權評分：

- **CLINICAL_VALUE** (22%): 臨床價值
- **TECH_FEAS** (18%): 技術可行性
- **UX** (12%): 使用者體驗
- **REG_PATH** (15%): 法規路徑
- **MARKET** (12%): 市場潛力
- **FINANCE** (8%): 財務可行性
- **IP_FTO** (8%): 智財與FTO
- **PAYER** (5%): 給付策略

## 🚀 快速開始

### 1. 安裝依賴
```bash
pip install -r requirements.txt
```

### 2. 設置環境變量
```bash
cp env.example .env
# 編輯 .env 文件，添加您的 OpenAI API 密鑰
```

### 3. 運行範例
```bash
python run_demo.py
```

## 📁 專案結構

```
biodesign_langgraph/
├── requirements.txt          # Python 依賴
├── env.example              # 環境變量範例
├── run_demo.py              # 執行範例
└── src/
    ├── __init__.py          # 包初始化
    ├── types.py             # 型別定義
    ├── prompts.py            # 專家提示詞
    ├── agents.py             # 代理與LLM包裝
    ├── scoring.py            # 評分彙總邏輯
    └── graph.py              # LangGraph 工作流
```

## 🔧 客製化選項

- **模型供應商**：修改 `src/agents.py` 中的 `get_llm` 函數
- **評分權重**：調整 `src/types.py` 中的 `CRITERIA_WEIGHTS`
- **回合數**：設置 `BiodesignDebate(rounds=..., use_delphi=True)`
- **Delphi 收斂**：控制是否啟用分歧收斂機制

## 📈 輸出結果

系統生成結構化分析，包括：

- **概念排名**：基於加權總分的排序
- **敏感度分析**：Top-1 與 Top-2 的差異分析
- **決策摘要**：下一步原型與驗證計畫
- **風險清單**：各概念的關鍵風險與緩解建議
- **完整辯論記錄**：所有專家的討論過程

## 🎯 適用場景

- 醫療器械創新概念評估
- 多專家意見整合與決策
- 風險評估與優先級排序
- 產品開發路徑規劃
- 法規合規策略制定

## 🔒 注意事項

- 系統使用 in-memory 狀態，不落資料庫
- 支援醫材專案的可稽核性（設計歷程、風險管理、法規思維）
- 不直接產生臨床試驗計畫書與法遵最終文件
- 可插拔介面設計，便於後續擴充

## 📞 支援

如有問題或建議，請提交 Issue 或聯繫開發團隊。 